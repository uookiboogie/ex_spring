<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dbal.app.book.mapper.BookMapper">

<!-- 도서전체조회 -->
<select id="getList" resultType="com.dbal.app.book.domain.BookVO">
  SELECT
  book_no,book_name,book_coverimg,book_date,book_price,book_publisher,book_info 
  FROM book_tbl_06
  ORDER BY book_no
</select>

<!-- 도서등록 -->
<insert id="insert">
  INSERT INTO 
  book_tbl_06(book_no, book_name, book_coverimg, book_date, book_price, book_publisher, book_info)
  VALUES(#{bookNo},#{bookName},#{bookCoverimg},#{bookDate},#{bookPrice},#{bookPublisher},#{bookInfo})  
</insert>

<!-- 등록될 도서번호조회 -->
<select id="getNo" resultType="int">
  SELECT MAX(book_no)+1 FROM book_tbl_06
</select>

<!--대여총계 대여횟수 조회 -->

<select id="get2List" resultType="com.dbal.app.book.domain.RentVO">
  SELECT b.book_no as bookNo, b.book_Name as bookName, SUM(r.rent_price) as bookSum, count(*) as bookCount
  FROM (BOOK_TBL_06) b JOIN (RENT_TBL_06) r
  ON b.book_no = r.book_no
  GROUP BY b.book_no, b.book_Name
  ORDER BY b.book_no
</select>

</mapper>